# 在 Github 上使用 Git Flow

这里介绍的是以 Git Flow 为基础，组合了 Github 的开发流程。

在这个开发流程中，每个分支都显示出代码的当前状态。流程中设置了负责管理软件发布 Release 的发布管理员，适用于以发布为中心的软件开发。

整体的流程图，如下：

![](images/git-model.png)

该流程用分支名表示标准软件开发中状态的迁移。

1.  从开发版的分支（develop）创建工作分支（feature branches），进行功能的实现或修正。

2.  工作分支（feature branches）的修改结束后，与开发版的分支（develop）进行合并。

3.  重复上述 1 和 2，不断实现功能直至可以发布。

4.  创建用于发布的分支（release branches），处理发布的各项工作。

5.  发布工作完成后与 master 分支合并，打上版本标签（Tag）进行发布。

6.  如果发布的软件出现 BUG，以打了标签的版本为基础进行修正（hotfixes）。

可以通过 git-flow 工具（https://github.com/nvie/gitflow ）辅助进行开发。即便如此，流程整体对于实际开发现场来说仍然显得过于复杂。

在这个流程中，程序员必须理解自己正在进行的修改会对哪些分支产生影响。一个分支的工作结束后，有时需要与多个目标分支合并。这些是该流程中最复杂的部分，需要团队谨慎处理。

## master 分支

`master` 分支时常保持着软件可以正常运行的状态。由于要维持这一状态，所以不允许开发者直接对 `master` 分支的代码进行修改和提交。

其他分支的开发工作进展到可以发布的程度后，将会与 `master` 分支进行合并，而且这一合并只在发布成品时进行。发布时会附加包含版本编号的 Git 标签（Tag）。

## develop 分支

`develop` 分支是开发过程中的代码中心分支。

程序员要以 `develop` 分支为起点新建 `feature` 分支，在 `feature` 分支中进行新功能的开发或者代码的修正。也就是说，`develop` 分支维持着开发过程中的最新源代码，以便程序员创建 `feature` 分支进行自己的工作。

## feature 分支

`feature` 分支以 `develop` 分支为起点，是开发者直接进行更改代码发送提交的分支。开发以下述流程进行：

1.  从 `develop` 分支创建 `feature` 分支；

2.  在 `feature` 分支中实现目标功能；

3.  通过 Github 向 `develop` 分支发送 Pull Request；

4.  接受其他开发者审查后，将 Pull Request 合并至 `develop` 分支。

与 `develop` 分支合并后，已经完成工作的 `feature` 分支就失去了作用，可以在适当的时候删除。

## release 分支

**版本号的分配规则**

版本控制策略规定了软件版本号的分配规则。比如在用 x.y.z 格式进行版本管理时的规则如下所示：

*   x 在重大功能变更或新版本不向下兼容时加1，此时 y 与 z 的数字归0。

*   y 在添加新功能或者删除已有功能时加1，此时 z 的数字归0。

*   z 只在进行内部修改后加1。

下面举个例子：

*   1.0.0：最初发布的版本。

*   1.0.1：修正了轻微 BUG。

*   1.0.2：修复漏洞。

*   1.1.0：添加新功能。

*   2.0.0：更新整体 UI 并添加新功能。

## hotfix 分支

只有当前发布的版本中出现 BUG 或漏洞，而且其严重程度要求开发方必须立刻处理，无法等到下一个版本发布时，才应该创建 `hotfix` 分支。

因此，`hotfix` 分支都是以发布版本的标签 或 `master` 分支为起点。借助 `hotfix` 分支，可以在不影响 `develop` 分支正常开发的情况下，由其他开发者处理成品的修正工作。